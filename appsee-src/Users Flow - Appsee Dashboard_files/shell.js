function initAppsee(){appsee.addWindowResizeHandler("MainContent",function(){adjustMainContentHeight();updateVersionsWrapperWidth()});appsee.postContextPreparation(function(n){var i=$("#main-content"),t;n?(t=$("#animation-content"),t.empty(),i.children().each(function(){$(this).detach();$(this).appendTo(t)}),t.show(),i.html('<div class="ajax-loader-large"><\/div>'),t.toggle("slide",{duration:200,done:function(){t.hide()}}),i.effect("slide",{direction:"right"},200)):i.html('<div class="ajax-loader-large"><\/div>')});appsee.postContextSuccessCallback(function(n){$("#main-content").html(n);prepareUpperFilterControls();updateLoadedContent();updateVersionsWrapperWidth();updateWindowTitle()});appsee.postContextErrorCallback(function(n,t){var i=t?$(t):$("#main-content");i.html(getGeneralErrorMessage())});appsee.beforeActionChange(!0,function(n){setFilterValuesForTargetAction(n);appsee.addEvent(n)});var n=$.map($(".noMultiSegment .context-action"),function(n){return $(n).attr("context")});appsee.setSingleSegmentActions(n)}function updateVersionsWrapperWidth(){var n=$("#versions-wrapper"),i=$("#main-content .title").outerWidth(!0)-parseInt($("#main-content .title").css("margin-right")),r=$("#main-content .title-text").width(),u=$("#main-content #filter").width(),t;n.hide();t=$("#filter").width();n.show();n.width(i-r-t-20);$("#versions").appseeDropdown("resize")}function updateWindowTitle(){title=$(".title").text().replace(/\n/g,"").trim();title.length>0?title+=" - Appsee Dashboard":title="Appsee Dashboard";$(document).prop("title",title)}function updateLoadedContent(){updateActionAnchors();prepareInfoHover();appseeUtils.prepareScreenActionHovers(!0);$(".fasttip").fasttip()}function initShellControls(){configureBox("#boxSurvey",850,650,!0);configureBox("#boxManageApps",820,600,!1,null,function(){document.location="/home"});configureBox("#boxManageAppsFromMenu",820,600,!1,null,function(){document.location="/home"});configureBox("#boxManageAccount",700,600,!0);configureBox("#boxTrial",700,600,!0);configureBox("#boxQuota",700,600,!0);var n=Math.min($("#select-app-box option").length,7)*53;$("#select-app-box").ddslick({width:"224px",height:n,background:"white",onSelected:function(n){$("#select-app-box .dd-selected label").attr("title",n.selectedData.text);n.selectedData.value=="#manage-apps"?(appsee.addEvent("Manage Apps"),$("#boxManageAppsFromMenu").click()):appsee.context.app!=n.selectedData.value&&(document.location.href="/home/"+n.selectedData.value)}});$("#select-app-box ul li").each(function(){var n=$(this);n.attr("title",n.find("label").text())})}function registerShellEvents(){$("#select-platform button").click(function(){if(!$(this).hasClass("active")){$(this).addClass("active").siblings().removeClass("active");var n=$(this).attr("context");adjustShellToPlatform(n);appsee.updateContext("platform",n)}});$(".context-action").click(function(){$(".popover").hide();var n=$(this).attr("actionParams");return n?(appsee.updateContextDeferred("action",$(this).attr("context")),appsee.updateContext("actionParams",n)):appsee.updateContext("action",$(this).attr("context"))});$(".menu-topLevelItem > a").click(function(n){n.preventDefault();topLevelMenuAnchorClicked($(this))});$(".submenu a").click(function(){submenuItemClicked($(this))})}function adjustShellToPlatform(n){$('#select-platform button[context="'+n+'"]').addClass("active").siblings().removeClass("active");$(".specific-platform").hide();n=="all"?($(".noMultiPlatform .context-action").each(function(){var n=!0;return $(this).attr("context")==appsee.context.action&&(appsee.updateContextDeferred("action","/overview/index"),correlateMenuItemToContext(),n=!1),n}),$(".noMultiPlatform").hide(200)):($(".noMultiPlatform").show(200),$(".specific-platform."+n.toLowerCase()).show())}function prepareUpperFilterControls(){initUpperFilterDatePickers();registerUpperFilterEvents()}function updateDateSelectionFromContext(){var n,i,t;if(appsee.context.date){if(n=moment("07-01-2013","MM-DD-YYYY").utc(),i=moment().utc(),appsee.context.date.lastIndexOf("range",0)===0)t=appsee.context.date.split(","),t[1]!="min"&&(n=moment(t[1],"MM-DD-YYYY")),t[2]!="max"&&(i=moment(t[2],"MM-DD-YYYY"));else switch(appsee.context.date){case"day":n=moment().utc().subtract(1,"days");break;case"week":n=moment().utc().subtract(7,"days");break;case"month":n=moment().utc().subtract(30,"days")}$("#btn-open-date").length>0&&($("#btn-open-date").data("daterangepicker").setStartDate(n),$("#btn-open-date").data("daterangepicker").setEndDate(i),updateDateSelectionButton(n,i))}}function updateDateSelectionButton(n,t){if($("#btn-open-date").length>0){var i=n.format("MMM D, YYYY")+" - "+t.format("MMM D, YYYY");$("#btn-open-date").html('<span style="padding-right: 10px;"><i class="glyphicon glyphicon-calendar fa fa-calendar"><\/i><\/span>'+i)}}function initUpperFilterDatePickers(){$("#btn-open-date").daterangepicker({opens:"left",applyClass:"green",autoUpdateInput:!0,linkedCalendars:!1,alwaysShowCalendars:!0,showCustomRangeLabel:!1,parentEl:$("#date"),maxDate:moment().utc(),ranges:{Today:[moment().utc().startOf("day"),moment().utc()],Yesterday:[moment().utc().subtract(1,"days").startOf("day"),moment().utc().subtract(1,"days").endOf("day")],"Last 7 Days":[moment().utc().subtract(7,"days").startOf("day"),moment().utc()],"Last 30 Days":[moment().utc().subtract(30,"days").startOf("day"),moment().utc()],"Last 90 Days":[moment().utc().subtract(90,"days").startOf("day"),moment().utc()],"This Month":[moment().utc().startOf("month"),moment().utc()]}},function(n,t){var i=appsee.updateContext("date","range,"+n.format("MM-DD-YYYY")+","+t.format("MM-DD-YYYY"));return updateDateSelectionButton(n,t),i});updateDateSelectionFromContext()}function registerUpperFilterEvents(){$(".context-device").click(function(){return appsee.updateContext("device",$(this).attr("context"))});$(".context-device").click(function(){return $(this).addClass("active").siblings().removeClass("active"),!1});$("#btn-open-date").on("show.daterangepicker",function(){$("#btn-open-date").addClass("active");$(".daterange-utc-notification").length==0&&$(".ranges .range_inputs").append('<div class="daterange-utc-notification">Each day starts at midnight UTC<\/div>')});$("#btn-open-date").on("hide.daterangepicker",function(){$("#btn-open-date").removeClass("active")})}function setFilterValuesForTargetAction(n){if(appsee.context.platform!="all")if(appsee.isSingleSegmentAction(n)){var t=appsee.popularSegments[appsee.context.platform];appsee.context.device=="all"&&(t?(appsee.updateContextDeferred("device",t.DeviceType),appsee.dataStore.prevDevice="all"):appsee.updateContextDeferred("device","none"));appsee.context.version=="all"&&(t?(appsee.updateContextDeferred("version",t.AppVersion),appsee.dataStore.prevVersion="all"):appsee.updateContextDeferred("version","none"))}else appsee.dataStore.prevDevice&&(appsee.updateContextDeferred("device",appsee.dataStore.prevDevice),appsee.dataStore.prevDevice=null),appsee.dataStore.prevVersion&&(appsee.updateContextDeferred("version",appsee.dataStore.prevVersion),appsee.dataStore.prevVersion=null)}function adjustMainContentHeight(){var n=$("#menu-container").height(),t=$("#main-content").outerHeight(!0)-$("#main-content").height(),i=n-t;$("#main-content").height(i)}function updateSingleActionAnchors(n){var t=appsee.getHash({action:$(n).attr("action"),actionParams:$(n).attr("actionParams"),platform:$(n).attr("segmentPlatform"),version:$(n).attr("segmentVersion"),device:$(n).attr("segmentDeviceType")});$(n).attr("href",t)}function updateActionAnchors(){var n=$("a[action]");$.each(n,function(n,t){updateSingleActionAnchors(t)})}function getGeneralErrorMessage(){return"<div class='general-error-msg'><h2>Oops!<\/h2><br/>Something went wrong. We are doing our best to solve this problem ASAP.<\/div>"}function getSelectedPlatform(){return $("#select-platform button.active").attr("context")}function prepareInfoHover(){$("#main-content .as-info-hover").appseeInfoHover()}function openAccountManagementDialog(n){n?displayBoxWithHref("/account?tab="+n,700,600):displayBoxWithHref("/account",700,600)}