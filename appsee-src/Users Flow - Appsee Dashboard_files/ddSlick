(function(n){function i(n,t){var r=n.data("ddslick"),o=n.find(".dd-selected"),h=o.siblings(".dd-selected-value"),l=n.find(".dd-options"),a=o.siblings(".dd-pointer"),s=n.find(".dd-option").eq(t),c=s.closest("li"),e=r.settings,i=r.settings.data[t];n.find(".dd-option").removeClass("dd-option-selected");s.addClass("dd-option-selected");r.selectedIndex=t;r.selectedItem=c;r.selectedData=i;e.showSelectedHTML?o.html((i.imageSrc?'<img class="dd-selected-image'+(e.imagePosition=="right"?" dd-image-right":"")+'" src="'+i.imageSrc+'" />':"")+(i.text?'<label class="dd-selected-text">'+i.text+"<\/label>":"")+(i.description?'<small class="dd-selected-description dd-desc'+(e.truncateDescription?" dd-selected-description-truncated":"")+'" >'+i.description+"<\/small>":"")):o.html(i.text);h.val(i.value);r.original.val(i.value);n.data("ddslick",r);u(n);f(n);typeof e.onSelected=="function"&&e.onSelected.call(this,r)}function r(t){var r=t.find(".dd-select"),i=r.siblings(".dd-options"),u=r.find(".dd-pointer"),f=i.is(":visible");n(".dd-click-off-close").not(i).slideUp(50);n(".dd-pointer").removeClass("dd-pointer-up");f?(i.slideUp("fast"),u.removeClass("dd-pointer-up")):(i.slideDown("fast"),u.addClass("dd-pointer-up"));e(t)}function u(n){n.find(".dd-options").slideUp(50);n.find(".dd-pointer").removeClass("dd-pointer-up").removeClass("dd-pointer-up")}function f(n){var t=n.find(".dd-select").css("height"),i=n.find(".dd-selected-description"),r=n.find(".dd-selected-image");i.length<=0&&r.length>0&&n.find(".dd-selected-text").css("lineHeight",t)}function e(t){t.find(".dd-option").each(function(){var i=n(this),r=i.css("height"),u=i.find(".dd-option-description"),f=t.find(".dd-option-image");u.length<=0&&f.length>0&&i.find(".dd-option-text").css("lineHeight",r)})}n.fn.ddslick=function(i){if(t[i])return t[i].apply(this,Array.prototype.slice.call(arguments,1));if(typeof i!="object"&&i)n.error("Method "+i+" does not exists.");else return t.init.apply(this,arguments)};var t={},o={data:[],keepJSONItemsOnTop:!1,width:260,height:null,background:"#eee",selectText:"",defaultSelectedIndex:null,truncateDescription:!0,imagePosition:"left",showSelectedHTML:!0,clickOffToClose:!0,onSelected:function(){}},s='<div class="dd-select"><input class="dd-selected-value" type="hidden" /><a class="dd-selected"><\/a><span class="dd-pointer dd-pointer-down"><\/span><\/div>',h='<ul class="dd-options"><\/ul>';n("#css-ddslick").length<=0&&n('<style id="css-ddslick" type="text/css">.dd-select{ border-radius:2px; border:solid 1px #ccc; position:relative; cursor:pointer;}.dd-desc { color:#aaa; display:block; overflow: hidden; font-weight:normal; line-height: 1.4em; }.dd-selected{ overflow:hidden; display:block; padding:10px; font-weight:bold;}.dd-pointer{ width:0; height:0; position:absolute; right:10px; top:50%; margin-top:-3px;}.dd-pointer-down{ border:solid 5px transparent; border-top:solid 5px #000; }.dd-pointer-up{border:solid 5px transparent !important; border-bottom:solid 5px #000 !important; margin-top:-8px;}.dd-options{ border:solid 1px #ccc; border-top:none; list-style:none; box-shadow:0px 1px 5px #ddd; display:none; position:absolute; z-index:2000; margin:0; padding:0;background:#fff; overflow:auto;}.dd-option{ padding:10px; display:block; border-bottom:solid 1px #ddd; overflow:hidden; text-decoration:none; color:#333; cursor:pointer;-webkit-transition: all 0.25s ease-in-out; -moz-transition: all 0.25s ease-in-out;-o-transition: all 0.25s ease-in-out;-ms-transition: all 0.25s ease-in-out; }.dd-options > li:last-child > .dd-option{ border-bottom:none;}.dd-option:hover{ background:#f3f3f3; color:#000;}.dd-selected-description-truncated { text-overflow: ellipsis; white-space:nowrap; }.dd-option-selected { background:#f6f6f6; }.dd-option-image, .dd-selected-image { vertical-align:middle; float:left; margin-right:5px; max-width:64px;}.dd-image-right { float:right; margin-right:15px; margin-left:5px;}.dd-container{ position:relative;}​ .dd-selected-text { font-weight:bold}​<\/style>').appendTo("head");t.init=function(t){var t=n.extend({},o,t);return this.each(function(){var u=n(this),v=u.data("ddslick"),y,c,o,f,e,l,a;if(!v){f=[];y=t.data;u.find("option").each(function(){var t=n(this),i=t.data();f.push({text:n.trim(t.text()),value:t.val(),selected:t.is(":selected"),description:i.description,imageSrc:i.imagesrc})});t.keepJSONItemsOnTop?n.merge(t.data,f):t.data=n.merge(f,t.data);c=u;o=n('<div id="'+u.attr("id")+'"><\/div>');u.replaceWith(o);u=o;u.addClass("dd-container").append(s).append(h);f=u.find(".dd-select");e=u.find(".dd-options");e.css({width:t.width});f.css({width:t.width,background:t.background});u.css({width:t.width});t.height!=null&&e.css({height:t.height,overflow:"auto"});n.each(t.data,function(n,i){i.selected&&(t.defaultSelectedIndex=n);e.append('<li><a class="dd-option">'+(i.value?' <input class="dd-option-value" type="hidden" value="'+i.value+'" />':"")+(i.imageSrc?' <img class="dd-option-image'+(t.imagePosition=="right"?" dd-image-right":"")+'" src="'+i.imageSrc+'" />':"")+(i.text?' <label class="dd-option-text">'+i.text+"<\/label>":"")+(i.description?' <small class="dd-option-description dd-desc">'+i.description+"<\/small>":"")+"<\/a><\/li>")});l={settings:t,original:c,selectedIndex:-1,selectedItem:null,selectedData:null};u.data("ddslick",l);t.selectText.length>0&&t.defaultSelectedIndex==null?u.find(".dd-selected").html(t.selectText):(a=t.defaultSelectedIndex!=null&&t.defaultSelectedIndex>=0&&t.defaultSelectedIndex<t.data.length?t.defaultSelectedIndex:0,i(u,a));u.find(".dd-select").on("click.ddslick",function(){r(u)});u.find(".dd-option").on("click.ddslick",function(){i(u,n(this).closest("li").index())});if(t.clickOffToClose){e.addClass("dd-click-off-close");u.on("click.ddslick",function(n){n.stopPropagation()});n("body").on("click",function(){n(".dd-click-off-close").slideUp(50).siblings(".dd-select").find(".dd-pointer").removeClass("dd-pointer-up")})}}})};t.select=function(t){return this.each(function(){t.index&&i(n(this),t.index)})};t.open=function(){return this.each(function(){var t=n(this),i=t.data("ddslick");i&&r(t)})};t.close=function(){return this.each(function(){var t=n(this),i=t.data("ddslick");i&&u(t)})};t.destroy=function(){return this.each(function(){var t=n(this),i=t.data("ddslick"),r;i&&(r=i.original,t.removeData("ddslick").unbind(".ddslick").replaceWith(r))})}})(jQuery)